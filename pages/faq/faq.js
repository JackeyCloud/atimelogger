// pages/faq/faq.js
Page({
  /**
   * 页面的初始数据
   */
  data: {
    faqList: [
      {
        id: 1,
        question: "如何开始记录时间？",
        answer: "在首页点击您想要记录的活动类别。如果当前有正在进行的记录，会弹出确认对话框询问是否切换；如果开启了预设功能（时长/备注），会显示相应的设置界面；否则会立即开始记录。首次使用建议先熟悉各项功能的开关设置。",
        expanded: false
      },
      {
        id: 2,
        question: "什么是预设时长功能？",
        answer: "预设时长功能允许您在开始记录前设定一个计划时长，比如25分钟的专注时间。支持内置时长选项（25/45/60/5/15分钟）或自定义时长。时间到后会有震动和弹窗提醒，您可以选择结束记录或继续。继续记录时会从预设时间开始累计，不包含超时部分。",
        expanded: false
      },
      {
        id: 3,
        question: "如何查看我的历史记录？",
        answer: "点击底部导航栏的\"历史\"选项卡，可以查看您的所有时间记录。您可以按类别、时间范围进行筛选，也可以搜索特定记录。",
        expanded: false
      },
      {
        id: 4,
        question: "如何查看时间统计数据？",
        answer: "点击底部导航栏的\"统计\"选项卡，可以查看您的时间分配饼图、趋势图和柱状图。您可以选择查看今天、本周、本月或本年的数据。",
        expanded: false
      },
      {
        id: 5,
        question: "如何添加新的活动类别？",
        answer: "在首页的类别网格中，点击\"+\"按钮，输入类别名称，选择颜色和图标，然后点击\"保存\"即可添加新类别。",
        expanded: false
      },
      {
        id: 6,
        question: "如何编辑或删除已有的记录？",
        answer: "在\"历史\"页面，点击您想要编辑的记录，进入详情页后可以修改开始时间、结束时间、类别或添加备注。如果要删除记录，在详情页点击\"删除\"按钮。",
        expanded: false
      },
      {
        id: 7,
        question: "如何暂停和恢复记录？",
        answer: "在记录进行中，点击\"暂停\"按钮可以暂停计时，暂停后点击\"继续\"按钮可以恢复计时。暂停的时间不会计入总时长。暂停状态下也可以直接点击\"停止记录\"结束记录，无需先继续再停止。",
        expanded: false
      },
      {
        id: 8,
        question: "数据会自动保存吗？",
        answer: "是的，所有的时间记录和设置都会自动保存在本地。但如果您卸载小程序或清除缓存，数据可能会丢失，建议定期导出重要数据。",
        expanded: false
      },
      {
        id: 9,
        question: "如何自定义类别的排序？",
        answer: "有两种方式：1）在首页长按任意类别进入拖拽模式，然后点击其他位置交换顺序；2）在\"设置\"页面的\"类别管理\"中通过拖拽调整。您也可以选择按使用频率自动排序。首页拖拽更加便捷直观。",
        expanded: false
      },
      {
        id: 10,
        question: "如何导出我的时间记录数据？",
        answer: "在\"设置\"页面，点击\"数据导出\"选项，选择要导出的数据范围，然后选择\"发送给好友\"或\"复制到剪贴板\"。建议定期备份重要数据以防丢失。",
        expanded: false
      },
      {
        id: 11,
        question: "如何导入之前备份的数据？",
        answer: "在\"设置\"页面，点击\"数据导入\"选项，可以选择\"从聊天记录选择文件\"或\"从剪贴板导入\"。导入将完全覆盖现有数据，建议先备份当前数据。",
        expanded: false
      },
      {
        id: 12,
        question: "历史页面如何搜索和筛选记录？",
        answer: "在\"历史\"页面，点击搜索框输入关键词搜索记录；点击筛选按钮可以按类别、时间范围（今天、昨天、本周、本月、自定义）进行筛选。支持组合搜索。",
        expanded: false
      },
      {
        id: 13,
        question: "如何在历史页面编辑记录的时间？",
        answer: "在\"历史\"页面点击要编辑的记录，在弹出的编辑窗口中可以修改开始日期、开始时间、结束日期、结束时间，选择后点击\"保存\"即可。注意：为保证数据准确性，只能编辑当前时间之前的记录，选择未来时间会自动调整为有效值。",
        expanded: false
      },
      {
        id: 14,
        question: "统计页面的不同图表有什么区别？",
        answer: "饼图显示各类别时间占比；趋势图显示每个类别在时间段内的变化趋势；柱状图直观对比各类别的总时长。可以切换查看今天、本周、本月、今年的数据。",
        expanded: false
      },
      {
        id: 15,
        question: "为什么切换图表类型时显示异常？",
        answer: "这是已知问题，我们已经修复。如果仍有异常，请尝试刷新页面或重新进入统计页面。图表切换时会自动清理并重新绘制，确保显示正确。",
        expanded: false
      },
      {
        id: 16,
        question: "数据会在多设备间同步吗？",
        answer: "不会。所有数据仅存储在当前设备的本地，不会自动同步到其他设备。如需在多设备使用，可以通过导出/导入功能手动迁移数据。",
        expanded: false
      },
      {
        id: 17,
        question: "删除的记录可以恢复吗？",
        answer: "无法恢复。删除记录是永久性操作，建议在删除重要数据前先导出备份。您也可以选择编辑记录而不是删除。",
        expanded: false
      },
      {
        id: 18,
        question: "什么是预设备注功能？",
        answer: "预设备注功能让您可以在开始记录前添加备注，方便记录工作内容或任务详情。开启后，点击类别时会弹出备注输入框，您可以提前填写相关信息，而不需要等记录结束后再添加。",
        expanded: false
      },
      {
        id: 19,
        question: "如何自定义预设时长？",
        answer: "在预设时长选择器中，点击\"自定义\"选项，输入您想要的分钟数（如90、120等），点击确定即可。自定义的时长会显示在选项中并保持选中状态，方便下次使用。",
        expanded: false
      },
      {
        id: 20,
        question: "当我正在记录时误点了其他类别怎么办？",
        answer: "系统会自动弹出确认对话框，显示当前正在记录的类别和状态（进行中/已暂停），询问是否确定切换。只有点击\"确定切换\"才会结束当前记录并开始新记录，点击\"取消\"则保持当前记录不变。",
        expanded: false
      },
      {
        id: 21,
        question: "如何调整首页类别的排列顺序？",
        answer: "长按任意类别图标进入拖拽模式，然后点击其他类别位置即可交换位置。完成后点击\"完成\"按钮退出拖拽模式。首次使用时会有操作提示。排序会自动保存。",
        expanded: false
      },
      {
        id: 22,
        question: "为什么编辑记录时不能选择未来的日期和时间？",
        answer: "为了确保记录的准确性，系统限制只能编辑当前时间之前的记录。选择未来日期或时间时会自动调整为有效值并提示用户。这样可以避免数据错误和统计偏差。",
        expanded: false
      },
      {
        id: 23,
        question: "很短的时间记录（不到1分钟）如何显示？",
        answer: "不到1分钟的记录会显示具体秒数（如\"30秒\"、\"45秒\"），而不是显示\"0分钟\"。这样可以更准确地反映实际记录时间，对于短时间任务的统计更加精确。",
        expanded: false
      },
      {
        id: 24,
        question: "预设时间结束后如果继续记录，时间是如何计算的？",
        answer: "预设时间结束后，计时器会停止在预设时长。如果您选择\"继续记录\"，系统会从预设时长开始继续累计时间，不会包含超时的部分。例如：设置25分钟，超时5分钟后选择继续，会从25分钟开始继续计时。",
        expanded: false
      },
      {
        id: 25,
        question: "暂停状态下可以直接停止记录吗？",
        answer: "可以。在记录暂停状态下，直接点击\"停止记录\"按钮即可结束记录，无需先继续再停止。系统会使用暂停时的准确时间作为最终记录时长。",
        expanded: false
      }
    ]
  },

  /**
   * 展开/收起FAQ项
   */
  toggleFaq: function(e) {
    const id = e.currentTarget.dataset.id;
    const faqList = this.data.faqList.map(item => {
      if (item.id === id) {
        return {
          ...item,
          expanded: !item.expanded
        };
      }
      return item;
    });
    
    this.setData({
      faqList
    });
  },

  /**
   * 联系我们
   */
  contactUs: function() {
    wx.showModal({
      title: '联系我们',
      content: '您可以通过以下方式联系我们：\n\n• 电子邮件：1945000000@qq.com\n• 微信公众号：大骏的百宝箱\n• 微信号：ui1945\n\n我们将在24小时内回复您的问题。',
      showCancel: false,
      confirmText: '知道了'
    });
  },

  /**
   * 生命周期函数--监听页面加载
   */
  onLoad: function (options) {
    // 应用当前主题
    const theme = wx.getStorageSync('theme') || 'default';
    const pageThemeClass = `${theme}-theme`;
    this.setData({
      pageThemeClass: pageThemeClass
    });
  },

  /**
   * 生命周期函数--监听页面初次渲染完成
   */
  onReady: function () {

  },

  /**
   * 生命周期函数--监听页面显示
   */
  onShow: function () {

  },

  /**
   * 生命周期函数--监听页面隐藏
   */
  onHide: function () {

  },

  /**
   * 生命周期函数--监听页面卸载
   */
  onUnload: function () {

  },

  /**
   * 页面相关事件处理函数--监听用户下拉动作
   */
  onPullDownRefresh: function () {

  },

  /**
   * 页面上拉触底事件的处理函数
   */
  onReachBottom: function () {

  },

  /**
   * 用户点击右上角分享
   */
  onShareAppMessage: function () {
    return {
      title: '大骏极简时间记录 - 常见问题解答',
      path: '/pages/faq/faq'
    };
  }
})